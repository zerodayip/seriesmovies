name: Push .m3u Files to Their Own Private Repos

on:
  workflow_dispatch:
  
jobs:
  push-to-dizigom:
    if: ${{ github.event.workflow_run.conclusion == 'success' || github.event_name == 'workflow_dispatch' }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout General Repo
        uses: actions/checkout@v4

      - name: Clone dizigom Repo
        run: |
          git clone https://x-access-token:${{ secrets.GH_TOKEN }}@github.com/zerodayip/dizigom.git private_dizigom

      - name: Copy dizigomdizi.m3u to dizigom Repo
        run: |
          cp dizigomdizi.m3u private_dizigom/dizigomdizi.m3u

      - name: Commit and Push to dizigom Repo
        run: |
          cd private_dizigom
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"
          git add dizigomdizi.m3u
          git diff --cached --quiet || git commit -m "Update dizigomdizi.m3u [auto]"
          git push origin main

  push-to-sezonlukdizi:
    if: ${{ github.event.workflow_run.conclusion == 'success' || github.event_name == 'workflow_dispatch' }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout General Repo
        uses: actions/checkout@v4

      - name: Clone sezonlukdizi Repo
        run: |
          git clone https://x-access-token:${{ secrets.GH_TOKEN }}@github.com/zerodayip/sezonlukdizi.git private_sezonlukdizi

      - name: Copy sezonlukdizi.m3u to sezonlukdizi Repo
        run: |
          cp sezonlukdizi.m3u private_sezonlukdizi/sezonlukdizi.m3u

      - name: Commit and Push to sezonlukdizi Repo
        run: |
          cd private_sezonlukdizi
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"
          git add sezonlukdizi.m3u
          git diff --cached --quiet || git commit -m "Update sezonlukdizi.m3u [auto]"
          git push origin main
